function addThousandsComma(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function currencyFormat(t){var e;return t>0?e="$"+addThousandsComma(t):0>t?e="-$"+addThousandsComma(parseInt(-1*t)):0==t&&(e="0"),e}function the_figure(t,e,r,a,n){var i,s=$(window).width()>768?3.5:2,o={top:10,right:35,bottom:30,left:50},l={left:$(window).width()>768?40:15,right:0,bottom:20,top:0},d=["red","blue"],c=["untreated","healthy"],f=!1,u=$(window).width()>1024,p=$(window).width()<960?$("body").width()-o.left-o.right-l.left-l.right:960-o.left-o.right-l.left-l.right,g=.506*p,h=parseInt(p+o.left+l.left+o.right),y=parseInt(g+o.top+l.top+o.bottom+l.bottom),m=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],x=y/50>4?parseInt(y/50):5;"yield"===r?(f=a,i=u?"Yield (Tons / Acre)":"Yield"):"netreturns"===r&&(f=n,i=u?"Cumulative Discounted Net Returns (2013 dollars)":"CDNR (2013 $)");for(var v=t.length,w=0;v>w;w++)if(f){var b=t[w].substr(4),C=""!==e.pc?e.pc:"0",k="Year "+b,A="yield"===r?"Figure "+parseInt(w+1)+"&#8212;Vineyard Yield (Tons per Acre) at Various Disease Control Efficacy Rates":"Figure "+parseInt(w+1)+"&#8212;Cumulative Discounted Net Returns per Acre at Various Disease Control Efficacy Rates";k+="netreturns"===r?" Adoption of $"+C+" per Acre-Year Preventative Practice":" Preventative Practice Adoption","Custom"!==e.friendlyRegion&&(k+=", "+e.friendlyRegion+" Region"),b&&(d=["yellowgreen","darkorchid","lightskyblue","red","blue"],c=["25y"+b,"50y"+b,"75y"+b,"untreated","healthy"]);var R=d3.scale.linear().range([0,p]),I=d3.scale.linear().range([g,0]),T=d3.svg.axis().scale(R).ticks(5).orient("bottom"),D=d3.svg.axis().scale(I).ticks(x).tickFormat(function(t){return currencyFormat(t)}).orient("left"),Y=d3.svg.line().x(function(t){return R(t.x)}).y(function(t){return I(t.y)}).interpolate("linear");$(".figure-area").append('<section class="figure-wrapper" id="figure'+b+'"><h4 class="figTitle">'+A+'</h4><h4 class="figSubhead">'+k+'</h4></section><p><a class="swipebox" href="#figure'+b+'"><i class="fa fa-search-plus" aria-hidden="true"></i> View fullscreen</a></p>');var F=d3.select("#figure"+b).append("svg").attr("width",h).attr("height",y).attr("id","figure"+b).append("g").attr("transform","translate("+parseInt(o.left+l.left)+","+o.top+")");R.domain(d3.extent(m)),I.domain(d3.extent(f.healthy,function(t){return t.y})),F.append("g").attr("class","x axis").attr("transform","translate(0,"+g+")").call(T).append("text").attr("x","50%").attr("y","3em").style("text-anchor","end").text("Vineyard Age (Years)"),F.append("g").attr("class","y axis").call(D).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text(i);for(var V in c)F.append("path").attr("d",Y(f[c[V]])).attr("class","line").attr("stroke",d[V]).attr("stroke-width",2).attr("fill","none"),F.selectAll("dot").data(f[c[V]]).enter().append("circle").attr("r",s).attr("fill",d[V]).attr("cx",function(t){return R(t.x)}).attr("cy",function(t){return I(t.y)})}$(".figure-area svg").each(function(){$(this).after('<div class="legend"><img src="img/figures/legend.png" /><br /><span class="glossary-link hide-on-print"><a href="efficacy-information.html">Disease control efficacy rate information</a></span></div>')}),0===v&&$(".figure-area").prepend('<p class="alert">To generate a figure, <a href="#" class="close-tab">close this tab</a> or return to the figure parameters form tab and select at least one year of practice adoption.</p>')}function type(t){return t.x=+t.x,t.y=+t.y,t}