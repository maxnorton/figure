function the_table(e,t,a,r,n,s,i,o,d,c,l,p,y){var u=[],h=$("select[name=region]").val();d3.tsv("regional-assumptions.tsv",function(f){var v;switch(h){case"napa":v=0;break;case"nsj":v=1;break;case"cc":v=2;break;case"lake":v=3;break;case"sonoma":v=4;break;case"custom":v=1}""==e&&(e="3",u.push("discount")),""==t&&(t=f[v].cost0,u.push("cost0")),""==a&&(a=f[v].cost1,u.push("cost1")),""==r&&(r=f[v].cost2,u.push("cost2")),""==n&&(n=f[v].cost3,u.push("cost3")),""==s&&(s=0,u.push("pc")),""==i&&(i=f[v].price,u.push("price")),""==o&&(o=f[v].yield0,u.push("yield0")),""==d&&(d=f[v].yield1,u.push("yield1")),""==c&&(c=f[v].yield2,u.push("yield2")),""==l&&(l=f[v].yield3,u.push("yield3")),""==p&&(p=f[v].yield4,u.push("yield4")),""==y&&(y=f[v].yield5,u.push("yield5"))}),d3.tsv("yield-rates.tsv",function(f){var v=[],b=[],g=[],k=[],m=[],I=[],w=[],C=[],x=[],D=[],F=[],A,E=1/(1+e/100),T=[],N={},j={},M=[],S=[],q=[],L=[],B={healthy:null,untreated:null,"25y3":0,"50y3":0,"75y3":0,"25y5":0,"50y5":0,"75y5":0,"25y10":0,"50y10":0,"75y10":0},J={healthy:null,untreated:null,"25y3":0,"50y3":0,"75y3":0,"25y5":0,"50y5":0,"75y5":0,"25y10":0,"50y10":0,"75y10":0},O={healthy:0,untreated:1,"25y3":0,"50y3":0,"75y3":0,"25y5":0,"50y5":0,"75y5":0,"25y10":0,"50y10":0,"75y10":0},_={healthy:"Healthy, untreated",untreated:"Infected, untreated","25y3":"25% DCE treatment adopted year 3","25y5":"25% DCE treatment adopted year 5","25y10":"25% DCE treatment adopted year 10","50y3":"50% DCE treatment adopted year 3","50y5":"50% DCE treatment adopted year 5","50y10":"50% DCE treatment adopted year 10","75y3":"75% DCE treatment adopted year 3","75y5":"75% DCE treatment adopted year 5","75y10":"75% DCE treatment adopted year 10"},z=Object.keys(_);j.healthy=[],j.untreated=[],N.healthy=[],N.untreated=[];var H=[parseInt(o),parseInt(d),parseInt(c),parseInt(l),parseInt(p),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y),parseInt(y)],P=[];for(var R in H)P[R]=H[R]*f[R].noAction/100,j.healthy[R]={x:R,y:H[R]},j.untreated[R]={x:R,y:P[R]};F=[t,a,r,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n];var U=[];for(R in P)U[R]=i*P[R]-F[R];var V=[];for(R in U)A=Math.pow(E,R),V[R]=U[R]*A;var G=[V[0]];for(R=1;R<V.length;R++)G[R]=V[R]+G[R-1];var K=[i*H[0]-F[0]],Q="-";for(R=1;R<H.length;R++)A=Math.pow(E,R),K[R]=(i*H[R]-F[R])*A+K[parseInt(R-1)],K[R]>K[parseInt(R-1)]&&(Q=R);var W=K[25]-G[25];W=0>W?"-$"+parseFloat(-1*W).toFixed(2):"$"+parseFloat(W).toFixed(2);var X=-1;for(R in K)if(K[R+1]>0){X=R;break}-1===X&&(X="Never breaks even",Q="-"),T=[];for(R in K)T[R]=K[R]-G[R];for(var Y=0;V[Y]<0&&25>Y;)Y++;if(25===Y)Y="Untreated vineyard never profitable";else{for(;V[Y]>0&&25>Y;)Y++;Y-=1}var Z="";if(u.length>0){var ee;switch(h){case"napa":ee="Napa";break;case"nsj":ee="Northern San Joaquin";break;case"cc":ee="Central Coast";break;case"lake":ee="Lake";break;case"sonoma":ee="Sonoma";break;case"custom":ee="Northern San Joaquin"}for(Z='<p class="alert">No values specified for: ',R=0;R<u.length-1;R++){var te;switch(u[R]){case"price":te="price per ton";break;case"discount":te="discount rate";break;case"pc":te="preventative practice cost";break;case"cost0":te="year 0 cultural cost";break;case"cost1":te="year 1 cultural cost";break;case"cost2":te="year 2 cultural cost";break;case"cost3":te="year 3 cultural cost";break;case"yield0":te="year 0 yield";break;case"yield1":te="year 1 yield";break;case"yield2":te="year 2 yield";break;case"yield3":te="year 3 yield";break;case"yield4":te="year 4 yield";break;case"yield5":te="year 5+ yield"}Z+=te+", "}console.log($.inArray("pc",u));var ae=$.inArray("pc",u)>=0?"with an preventative practice cost of zero, as with delayed pruning.</p>":".</p>";Z+=u[R]+'</p><p class="alert">Calculations below have been performed using default values for the '+ee+" region"+ae}var re="<hr /><h2>Results</h2>"+Z+'<section class="figure-area"></section><h3>Output table</h3><table><thead><th><h4>Scenario</h4></th><th><h4>ACDNB</h4></th><th><h4>Age adoption pays off</h4></th><th><h4>Last profitable year</h4></th><th><h4>Infection probability threshold</h4></th></thead><tbody>';re+="<tr><td>"+_.healthy+"</td><td>"+W+"</td><td>"+X+"</td><td>"+Q+"</td><td>0</td></tr>",re+="<tr><td>"+_.untreated+"</td><td>-</td><td>-</td><td>"+Y+"</td><td>1</td></tr>";for(var ne=2;ne<z.length;ne++){for(var se=z[ne],ie=parseInt(se.substr(3)),oe=[],de=0;ie>de;de++)oe[de]=0;for(de=ie;26>de;de++)oe[de]=s;var ce=[];for(R in H)ce[R]=i*H[R]-F[R]-oe[R];var le=[];for(R in ce)A=Math.pow(E,R),le[R]=ce[R]*A;var pe=[le[0]];for(R=1;R<le.length;R++)pe[R]=le[R]+pe[R-1];for(R in pe)N.healthy[R]={x:R,y:pe[R]},N.untreated[R]={x:R,y:G[R]};M=[];for(R in H)M[R]=H[R]*f[R][se]/100;var ye=z[ne];j[ye]=[];for(R in H)j[ye][R]={x:R,y:M[R]};S=[];for(R in M)S[R]=i*M[R]-F[R]-oe[R];q=[];for(R in S)A=Math.pow(E,R),q[R]=S[R]*A;for(L=[q[0]],R=1;R<q.length;R++)L[R]=q[R]+L[R-1];N[ye]=[];for(R in H)N[ye][R]={x:R,y:L[R]};for(D=[parseInt(oe[0])],R=1;R<le.length;R++)D[R]=parseInt(oe[R])+parseInt(D[R-1]);var ue=[];for(R in L)ue[R]=L[R]-G[R];switch(se){case"25y3":v=ue;break;case"25y5":b=ue;break;case"25y10":g=ue;break;case"50y3":k=ue;break;case"50y5":m=ue;break;case"50y10":I=ue;break;case"75y3":w=ue;break;case"75y5":C=ue;break;case"75y10":x=ue}for(R in L)if(L[R]>G[R]){B[se]=R;break}for(0===parseInt(B[se])&&L[0]<=G[0]&&(B[se]="Never breaks even"),J[se]=se.substr(3);S[parseInt(J[se])+1]<=0&&parseInt(J[se])<25;)J[se]++;if(25===parseInt(J[se]))J[se]="Treatment never profitable";else for(;S[parseInt(J[se])+1]>0&&parseInt(J[se])<25;)J[se]++;O[se]=(K[25]-pe[25])/(L[25]-pe[25]-(G[25]-K[25])),O[se]>1&&(O[se]=1),O[se]=O[se].toFixed(3);var he=null!==ue[25]?ue[25].toFixed(2):"-";"-"!==he&&0>he?he="-$"+parseFloat(-1*he).toFixed(2):"-"!==he&&(he="$"+parseFloat(he).toFixed(2)),re+="<tr><td>"+_[se]+"</td><td>"+he+"</td><td>"+B[se]+"</td><td>"+J[se]+"</td><td>"+O[se]+"</td></tr>"}var fe='<section class="varDefs-printable"><h3 id="variabledefinitions">Variable definitions</h3><p><strong>Cumulative discounted net returns:</strong> The cumulative net returns (returns &minus; costs) per acre over 25 years for a healthy vineyard, an untreated infected vineyard, and infected vineyards where action is taken. Current and future dollar amounts are in 2013 dollars and are discounted to 2013 using a 3% discount rate. </p><p><a id="tablevars"></a></p><p><strong>Additional cumulative discounted net benefits (ACDNB):</strong> The difference in cumulative net returns (returns - costs) per acre over 25 years between an infected vineyard where action is taken and an untreated infected vineyard. Current and future dollar amounts are in 2013 dollars and are discounted to 2013 using a 3% discount rate. </p><p><strong>Last profitable year:</strong> The last year an infected vineyard generates positive annual net returns (returns - costs). This year is the same for discounted and nominal net returns. </p><p><strong>Age adoption pays off:</strong> The age when cumulative discounted net returns (returns â€“ costs) for a treated infected vineyard exceed those from an untreated infected vineyard. </p><p><strong>Infection probability threshold:</strong> The probability of infection where expected cumulative discounted net returns from treating a vineyard equals the expected cumulative discounted net returns from not treating a vineyard. If you perceive a probability of infection less than this probability, then not treating the vineyard generates greater cumulative discounted net returns than a treated vineyard, and vice versa. </p></section>';re+="</tbody></table>"+fe+'<p class="print-link"><a href="javascript:window.print()"><i class="fa fa-print" aria-hidden="true"></i> Print these results.</a></p><p class="adjust-link"><a href="#figureparameters" onclick="$(\'body,html\').stop(true,true).animate({scrollTop: $(\'#figureparameters\').offset().top - $(\'header\').height()}, \'500\', \'swing\');">Adjust parameters</a></p>',$(".results").html(re),the_figure(j,N),$("body,html").stop(!0,!0).animate({scrollTop:$("#results").offset().top-$("header").height()},"500","swing")})}