function the_table(e,t,a,r,s,n,d,y,h,l,o,i,p){d3.tsv("yield-rates.tsv",function(f){var v,c,u,I,b,Y,k,m,w,g,x,D,C,F,E=new Array,j={healthy:null,untreated:null,"25y3":0,"50y3":0,"75y3":0,"25y5":0,"50y5":0,"75y5":0,"25y10":0,"50y10":0,"75y10":0},A={healthy:null,untreated:null,"25y3":0,"50y3":0,"75y3":0,"25y5":0,"50y5":0,"75y5":0,"25y10":0,"50y10":0,"75y10":0},N={healthy:0,untreated:1,"25y3":0,"50y3":0,"75y3":0,"25y5":0,"50y5":0,"75y5":0,"25y10":0,"50y10":0,"75y10":0},O={healthy:"Healthy, untreated",untreated:"Infected, untreated","25y3":"25% DCE treatment adopted year 3","25y5":"25% DCE treatment adopted year 5","25y10":"25% DCE treatment adopted year 10","50y3":"50% DCE treatment adopted year 3","50y5":"50% DCE treatment adopted year 5","50y10":"50% DCE treatment adopted year 10","75y3":"75% DCE treatment adopted year 3","75y5":"75% DCE treatment adopted year 5","75y10":"75% DCE treatment adopted year 10"},M=Object.keys(O),R=new Object,T=new Object;R.healthy=[],R.untreated=[],T.healthy=[],T.untreated=[];var B=1/(1+e/100);healthyYields=[parseInt(y),parseInt(h),parseInt(l),parseInt(o),parseInt(i),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p),parseInt(p)],untreatedYields=[];for(var P in healthyYields)untreatedYields[P]=healthyYields[P]*f[P].noAction/100;for(var P in healthyYields)R.healthy[P]={x:P,y:healthyYields[P]},R.untreated[P]={x:P,y:untreatedYields[P]};costs=[t,a,r,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s];var _=[];for(var P in untreatedYields)_[P]=d*untreatedYields[P]-costs[P];var H=[];for(var P in _){var L=Math.pow(B,P);H[P]=_[P]*L}for(var S=[H[0]],P=1;P<H.length;P++)S[P]=H[P]+S[P-1];for(var U=[d*healthyYields[0]-costs[0]],q="-",P=1;P<healthyYields.length;P++){var L=Math.pow(B,P);U[P]=(d*healthyYields[P]-costs[P])*L+U[parseInt(P-1)],U[P]>U[parseInt(P-1)]&&(q=P)}var z=U[25]-S[25];z=0>z?"-$"+parseFloat(-1*z).toFixed(2):"$"+parseFloat(z).toFixed(2);var G=-1;for(var P in U)if(U[P+1]>0){G=P;break}-1==G&&(G="Never breaks even",q="-"),v=[];for(var P in U)v[P]=U[P]-S[P];for(var J=0;H[J]<0&&25>J;)J++;if(25==J)J="Untreated vineyard never profitable";else{for(;H[J]>0&&25>J;)J++;J-=1}var K='<hr /><h2>Results</h2><section class="figure-area"></section><h3>Output table</h3><table><thead><th><h4>Scenario</h4></th><th><h4>ACDNB</h4></th><th><h4>Breakeven age</h4></th><th><h4>Last profitable year</h4></th><th><h4>Breakeven probability</h4></th></thead><tbody>';K+="<tr><td>"+O.healthy+"</td><td>"+z+"</td><td>"+G+"</td><td>"+q+"</td><td>0</td></tr>",K+="<tr><td>"+O.untreated+"</td><td>-</td><td>-</td><td>"+J+"</td><td>1</td></tr>";for(var Q=2;Q<M.length;Q++){for(var V=M[Q],W=parseInt(V.substr(3)),X=[],Z=0;W>Z;Z++)X[Z]=0;for(var Z=W;26>Z;Z++)X[Z]=n;var ee=[];for(var P in healthyYields)ee[P]=d*healthyYields[P]-costs[P]-X[P];var te=[];for(var P in ee){var L=Math.pow(B,P);te[P]=ee[P]*L}for(var ae=[te[0]],P=1;P<te.length;P++)ae[P]=te[P]+ae[P-1];for(var P in ae)T.healthy[P]={x:P,y:ae[P]},T.untreated[P]={x:P,y:S[P]};x=[];for(var P in healthyYields)x[P]=healthyYields[P]*f[P][V]/100;var re=M[Q];R[re]=[];for(var P in healthyYields)R[re][P]={x:P,y:x[P]};D=[];for(var P in x)D[P]=d*x[P]-costs[P]-X[P];C=[];for(var P in D){var L=Math.pow(B,P);C[P]=D[P]*L}F=[C[0]];for(var P=1;P<C.length;P++)F[P]=C[P]+F[P-1];T[re]=[];for(var P in healthyYields)T[re][P]={x:P,y:F[P]};E=[parseInt(X[0])];for(var P=1;P<te.length;P++)E[P]=parseInt(X[P])+parseInt(E[P-1]);var se=[];for(var P in F)se[P]=F[P]-S[P];switch(V){case"25y3":c=se;break;case"25y5":u=se;break;case"25y10":I=se;break;case"50y3":b=se;break;case"50y5":Y=se;break;case"50y10":k=se;break;case"75y3":m=se;break;case"75y5":w=se;break;case"75y10":g=se}for(var P in F)if(F[P]>S[P]){j[V]=P;break}for(0==j[V]&&F[0]<=S[0]&&(j[V]="Never breaks even"),A[V]=V.substr(3);D[parseInt(A[V])+1]<=0&&parseInt(A[V])<25;)A[V]++;if(25==parseInt(A[V]))A[V]="Treatment never profitable";else for(;D[parseInt(A[V])+1]>0&&parseInt(A[V])<25;)A[V]++;N[V]=(U[25]-ae[25])/(F[25]-ae[25]-(S[25]-U[25])),N[V]>1&&(N[V]=1),N[V]=N[V].toFixed(3);var ne=null!=se[25]?se[25].toFixed(2):"-";"-"!=ne&&0>ne?ne="-$"+parseFloat(-1*ne).toFixed(2):"-"!=ne&&(ne="$"+parseFloat(ne).toFixed(2)),K+="<tr><td>"+O[V]+"</td><td>"+ne+"</td><td>"+j[V]+"</td><td>"+A[V]+"</td><td>"+N[V]+"</td></tr>"}K+='</tbody></table><p class="print-link"><a href="javascript:window.print()"><i class="fa fa-print" aria-hidden="true"></i> Print these results.</a></p><p class="adjust-link"><a href="#form" onclick="$(\'body,html\').stop(true,true).animate({scrollTop: $(\'#form\').offset().top - $(\'header\').height()}, \'500\', \'swing\');">Adjust parameters</a></p>',$(".results").html(K),the_figure(R,T),$("body,html").stop(!0,!0).animate({scrollTop:$("#results").offset().top-$("header").height()},"500","swing")})}var t,a,eff,discount,cost0,cost1,cost2,cost3,pc,price,yield0,yield1,yield2,yield3,yield4,treatedCDNR,treatedDNR,treatedNR,treatedYields=new Array,costs,pcFtnOfT,isProfitable=new Array;